<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>CTF Writeups</title>

<style>
body{
    display:flex;
    font-family:Arial;
}

#sidebar{
    width:250px;
    border-right:1px solid #ccc;
    padding:10px;
}

#content{
    flex:1;
    padding:20px;
}

.folder{
    font-weight:bold;
    cursor:pointer;
}

.file{
    margin-left:15px;
    cursor:pointer;
    color:blue;
}
</style>

</head>
<body>

<div id="sidebar">
<h3>Writeups</h3>
<div id="tree"></div>
</div>

<div id="content">
<h2>Select file</h2>
</div>

<script>

const user = "1abhax";
const repo = "CTF";
const branch = "docs";

async function loadDir(path="", container){
    const url =
    `https://api.github.com/repos/${user}/${repo}/contents/${path}?ref=${branch}`;

    const res = await fetch(url);
    const data = await res.json();

    data.forEach(item => {

        const div = document.createElement("div");

        if(item.type === "dir"){

            div.innerText = "ðŸ“ " + item.name;
            div.className = "folder";

            const sub = document.createElement("div");
            sub.style.marginLeft="15px";

            div.onclick = () => {
                if(sub.innerHTML===""){
                    loadDir(item.path, sub);
                }
                sub.style.display =
                    sub.style.display === "none" ? "block" : "none";
            };

            container.appendChild(div);
            container.appendChild(sub);

        }else{

            div.innerText = "ðŸ“„ " + item.name;
            div.className = "file";

            div.onclick = () => {
                document.getElementById("content").innerHTML =
                    `<iframe src="${item.html_url}" width="100%" height="800"></iframe>`;
            };

            container.appendChild(div);
        }
    });
}

loadDir("", document.getElementById("tree"));

</script>

</body>
</html>
